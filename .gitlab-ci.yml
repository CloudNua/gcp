image: alpine:latest

include:
  - project: 'cloudnua-public/gitops/infra/templates'
    ref: main
    file:
      - '/terraform.gitlab-ci.yml'

# Using protected pipeline variable for initial deployment
variables:
  GCP_CREDENTIALS: $GCP_CREDENTIALS
  GCP_PROJECT_ID: $GCP_PROJECT_ID
  GCP_REGION: $GCP_REGION
  GITLAB_TOKEN: $GITLAB_TOKEN

# Using protected pipeline variable for initial deployment
before_script:
  - echo "Initialise GCP GKE Stack...START!"
  - export GOOGLE_APPLICATION_CREDENTIALS=${GCP_CREDENTIALS}
after_script:
  - echo ""Initialise GCP GKE Stack...DONE!""